<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Filip & Simon</title>
  <!-- Dynamic background -->
  <script src="http://threejs.org/build/three.min.js"></script>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Bungee+Shade" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Bungee Inline">
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Fugaz One">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">


</head>

<body style="margin: 0px; -webkit-font-smoothing: antialiased;">
  <div style="width: 100%; height: 100%; margin: 0px; position: fixed;"id="container"></div>
  <div id="root"></div>


  <script type="x-shader/x-fragment" id="fragmentShader">  


		uniform vec2 resolution;
		uniform vec2 mouse;
		uniform float mouseHold;
		uniform float time;
		varying vec3 newPos;

		void main() {

      float realTime = time;

			vec2 position = ( gl_FragCoord.xy / resolution.xy );
			position.x/=1.0;
			position.y	/=1.0;
			float color = 0.3;
			vec2 point1 = vec2(0.0, 1.0);
			vec2 point2 = vec2(0.7, -0.3);
			vec2 mp_vec = position - point2;
			vec2 middle = position - point2;
			mp_vec.y *= 2.0;
			float mp = length(mp_vec)*6.0;
			float middle_length = length(middle)*6.0;
			color /= sin(7.8*( 1.5 + (0.3*sin(0.1*realTime)))*mp/abs(middle_length+0.1) - 0.1*realTime);
      color += (0.1*abs(sin(gl_FragCoord.y)) + 0.9);
      color = max(min(color, 1.0), 0.0);
      color *= .15 + 0.3 + 0.2 * mouseHold;
      color += (0.1*abs(sin(gl_FragCoord.x)));

      gl_FragColor = vec4(vec3(color) + vec3(0.7, 0.4, 0.1), 1.0 );
      
		}
  </script>

  <script>
    let camera, scene, renderer;
    let clock = new THREE.Clock();
    let mouse = new THREE.Vector2(0, 0);
    let mouseHold = 0.0;
    let mouseDelayed = new THREE.Vector2(0, 0);
    let mesh;
    let uniforms;

    init();
    animate();
    function init() {
      camera = new THREE.PerspectiveCamera(10, window.innerWidth / window.innerHeight, 1, 1000);
      camera.position.z = 1;
      scene = new THREE.Scene();
      let geometry = new THREE.PlaneGeometry( 0.35, 0.175, 1 );

      uniforms = {
        resolution: { value: new THREE.Vector2(window.innerWidth, window.innerHeight) },
        mouse: { value: new THREE.Vector2(1, 0) },
        mouseDelayed: { value: new THREE.Vector2(1, 0) },
        time: { value: 1.0 },
        mouseHold: { value: 0.0 },
      };


      let shaderMaterial = new THREE.ShaderMaterial({
        uniforms: uniforms,
        fragmentShader: document.getElementById('fragmentShader').textContent,
        wireframe: false
      });
      
      mesh = new THREE.Mesh(geometry, shaderMaterial);
      
      scene.add(mesh);
      renderer = new THREE.WebGLRenderer();
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(window.innerWidth, window.innerHeight);



      let container = document.getElementById('container');
      container.appendChild(renderer.domElement);
      container.append(renderer.domElement);

      
      
      
      window.addEventListener('resize', onWindowResize, false);
    }
    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
      requestAnimationFrame(animate);
      mouseDelayed.x = mouseDelayed.x - 0.09 * (mouseDelayed.x - mouse.x);
      mouseDelayed.y = mouseDelayed.y - 0.09 * (mouseDelayed.y - mouse.y);
      camera.updateMatrixWorld();
      let delta = 0.5*clock.getDelta();
      uniforms.time.value += delta * (1.0 + mouseHold * 30.0);
      uniforms.mouse.value = mouse;
      uniforms.mouseHold.value = mouseHold;
      uniforms.mouseDelayed.value = mouseDelayed;
      renderer.render(scene, camera);
    }
  </script>

</body>

</html>